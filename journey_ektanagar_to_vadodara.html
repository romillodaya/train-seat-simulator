
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Journey Viewer: Ektanagar to Vadodara</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        :root { --color-reserved: #14b8a6; --color-available: #e5e7eb; --color-searched: #22c55e; --color-text: #1f2937; --color-bg: #f9fafb; --color-aisle: #f3f4f6; }
        body { font-family: 'Inter', sans-serif; background-color: var(--color-bg); -webkit-tap-highlight-color: transparent; }
        .coach-container { grid-template-columns: repeat(3, minmax(0, 1fr)) 1.25fr minmax(0, 1fr); }
        .seat { height: 50px; display: flex; flex-direction: column; align-items: center; justify-content: center; border-radius: 6px; box-shadow: 0 1px 3px rgba(0,0,0,0.1); user-select: none; position: relative; transition: all 0.15s ease-in-out; }
        .seat-number { font-weight: 700; font-size: 0.9rem; }
        .seat-type { font-size: 0.65rem; font-weight: 600; }
        .status-available { background-color: var(--color-available); color: var(--color-text); }
        .status-reserved { background-color: var(--color-reserved); color: white; }
        .status-searched { background-color: var(--color-searched); color: white; box-shadow: 0 0 15px 3px rgba(34, 197, 94, 0.6); transform: scale(1.05); z-index: 5; }
        .seat:hover .tooltip { visibility: visible; opacity: 1; }
        .tooltip { visibility: hidden; background-color: #333; color: #fff; text-align: center; border-radius: 6px; padding: 5px 10px; position: absolute; z-index: 10; bottom: 100%; left: 50%; transform: translateX(-50%) translateY(-5px); opacity: 0; transition: opacity 0.3s; white-space: nowrap; font-size: 0.8rem; pointer-events: none; }
    </style>
</head>
<body class="p-4 md:p-8">
    <div class="max-w-xl mx-auto">
        <div class="bg-white p-4 rounded-xl shadow-lg mb-6 border-b-4 border-indigo-500">
            <p class="text-lg font-semibold text-gray-700 text-center" id="coach-route"></p>
            <h1 class="text-xl font-bold text-gray-800 text-center" id="train-details"></h1>
            <p class="text-sm text-gray-500 mb-4 text-center" id="train-timing"></p>
            <h2 class="text-2xl font-bold text-gray-800 text-center" id="coach-heading"></h2>
            
            <div class="mt-4 pt-4 border-t border-gray-200 relative">
                <p class="text-sm font-semibold text-gray-700 mb-2">Search Passenger Name:</p>
                <input type="search" id="name-search-input" onkeyup="performSearch(this.value)" placeholder="Type a name..." class="w-full p-2 border border-gray-300 rounded-md text-sm">
                <div id="search-results-container" class="absolute z-10 w-full bg-white border border-gray-300 rounded-md mt-1 shadow-lg max-h-48 overflow-y-auto"></div>
            </div>
            <div class="mt-4 pt-4 border-t border-gray-200">
                <p class="text-sm font-semibold text-gray-700 mb-2">Select Coach:</p>
                <select id="coach-select" onchange="switchCoach(this.value)" class="w-full p-2 border border-gray-300 rounded-md bg-white text-sm"></select>
            </div>
        </div>
        <div class="grid grid-cols-3 gap-2 text-xs font-semibold text-gray-600 mb-4 px-2">
            <div class="flex items-center"><div class="w-3 h-3 rounded-full mr-1.5" style="background-color: var(--color-reserved);"></div>Reserved</div>
            <div class="flex items-center"><div class="w-3 h-3 rounded-full mr-1.5" style="background-color: var(--color-available);"></div>Available</div>
            <div class="flex items-center"><div class="w-3 h-3 rounded-full mr-1.5" style="background-color: var(--color-searched);"></div>Searched</div>
        </div>
        <div id="coach-container" class="bg-white p-3 border-4 border-gray-700 rounded-xl shadow-2xl grid gap-1 coach-container"></div>
    </div>
    <script>
        const journeyData = {"routeTitle":"Ektanagar to Vadodara","trainName":"EKNR DDR SF EXP","trainNumber":"12928","trainTiming":"22rd Dec (21:25) - 22th Dec (22:50)","coaches":{"S4":{"seats":{"15":{"name":"Urvi Nagda"},"16":{"name":"Akshita Maisheri"},"17":{"name":"Antara Chedda"},"18":{"name":"Darshit Momaya"},"19":{"name":"Pujan Chheda"},"20":{"name":"Chetna Momaya"},"21":{"name":"Hirali Chedda"},"22":{"name":"Sonal Shah"},"23":{"name":"Roneet Patel"},"24":{"name":"Yukta Khona"},"25":{"name":"Astha Momaya"},"26":{"name":"Darshan Nagda"},"27":{"name":"Darshan Lodaya"},"28":{"name":"Chirag Khona"},"29":{"name":"Gaurav Khona"},"30":{"name":"Vaibhavi Dharams"},"58":{"name":"Sandesh Lodaya"},"59":{"name":"Vamini Patel"}}}}};
        const appState = {
            currentCoachName: null,
            searchedSeat: null
        };

        function switchCoach(coachName) {
            appState.currentCoachName = coachName;
            document.getElementById('coach-heading').textContent = 'Coach: ' + coachName;
            document.getElementById('coach-select').value = coachName;
            renderCoach();
        }

        function getSeatType(num) { const m=num%8; if(m===7)return'SL'; if(m===0)return'SU'; const n=(num-1)%8+1; if(n===1||n===4)return'L'; if(n===2||n===5)return'M'; return'U'; }
        
        function renderCoach() {
            const container = document.getElementById('coach-container');
            let htmlContent = '';
            for (let bay = 0; bay < 9; bay++) {
                const bayStart = bay * 8;
                htmlContent += createSeatHTML(bayStart + 1) + createSeatHTML(bayStart + 2) + createSeatHTML(bayStart + 3) + '<div></div>' + createSeatHTML(bayStart + 7);
                htmlContent += createSeatHTML(bayStart + 4) + createSeatHTML(bayStart + 5) + createSeatHTML(bayStart + 6) + '<div></div>' + createSeatHTML(bayStart + 8);
                if (bay < 8) htmlContent += '<div class="col-span-5 h-1 bg-gray-200 my-1 rounded-full"></div>';
            }
            container.innerHTML = htmlContent;
        }

        function createSeatHTML(seatNumber) {
            const seatNumStr = String(seatNumber);
            const seatData = journeyData.coaches[appState.currentCoachName].seats[seatNumStr];
            let statusClass = 'status-available';
            let tooltipHTML = '';
            if (appState.searchedSeat?.coach === appState.currentCoachName && appState.searchedSeat?.seat === seatNumStr) {
                statusClass = 'status-searched';
            } else if (seatData) {
                statusClass = 'status-reserved';
                tooltipHTML = `<div class="tooltip">${seatData.name}</div>`;
            }
            return `<div class="seat ${statusClass}">
                        <span class="seat-number">${seatNumber}</span>
                        <span class="seat-type">${getSeatType(seatNumber)}</span>
                        ${tooltipHTML}
                    </div>`;
        }

        function performSearch(query) {
            const container = document.getElementById('search-results-container');
            container.innerHTML = '';
            if (query.length < 2) return;
            const results = [];
            for (const coachName in journeyData.coaches) {
                for (const seatNumber in journeyData.coaches[coachName].seats) {
                    const passenger = journeyData.coaches[coachName].seats[seatNumber];
                    if (passenger.name.toLowerCase().includes(query.toLowerCase())) {
                        results.push({ coach: coachName, seat: seatNumber, name: passenger.name });
                    }
                }
            }
            results.forEach(res => {
                const div = document.createElement('div');
                div.className = 'p-2 text-sm hover:bg-gray-100 cursor-pointer';
                div.textContent = `${res.name} (Coach: ${res.coach}, Seat: ${res.seat})`;
                div.onclick = () => {
                    appState.searchedSeat = { coach: res.coach, seat: res.seat };
                    document.getElementById('name-search-input').value = '';
                    container.innerHTML = '';
                    switchCoach(res.coach);
                };
                container.appendChild(div);
            });
        }
        
        window.onload = () => {
            document.getElementById('coach-route').textContent = journeyData.routeTitle;
            document.getElementById('train-details').textContent = `${journeyData.trainName} (${journeyData.trainNumber})`;
            document.getElementById('train-timing').textContent = journeyData.trainTiming;

            const coachSelect = document.getElementById('coach-select');
            const sortedCoaches = Object.keys(journeyData.coaches).sort();
            sortedCoaches.forEach(name => {
                const option = document.createElement('option');
                option.value = name;
                option.textContent = name;
                coachSelect.appendChild(option);
            });
            switchCoach(sortedCoaches[0]);
        };
    </script>
</body>
</html>
